# UUID
## Определение
```uuid``` (англ. **universally unique identifier, «универсальный уникальный идентификатор»**) — это 128-битное значение. Его генерирует специальный алгоритм таким образом, что это значение уникально не только внутри конкретной БД, но и среди всех существующих в мире баз данных.  
Такая уникальность uuid позволяет интегрировать данные из нескольких БД, применяя сквозной уникальный идентификатор.  
Самая распространённая версия — четвёртая, `uuid4`, где значение генерируется случайным образом.   
Именно так выводится значение uuid в **PostgreSQL**: 
`f01b5cba-bc79-4123-ba67-f03729f3c779`.  

## Генерация `UUID`  
Просто для генерации случайного значения используют:  
```SQL
SELECT GEN_RANDOM_UUID()
```  

При создании таблицы эту функцию часто используют как значение по умолчанию для одного из столбцов.  
```SQL
CREATE TABLE drivers (
guid uuid PRIMARY KEY DEFAULT GEN_RANDOM_UUID(),
driver_name text,
driver_license bigint,
depot_id integer)
```   

Теперь при вставке можно как указывать явно (функция или значение) так и не указывать guid вовсе:  
```SQL
INSERT INTO drivers (guid, driver_name, driver_license, depot_id) 
VALUES (GEN_RANDOM_UUID(), 'Земцов Вячеслав Николаевич', '4444567567', NULL)
```
```SQL
INSERT INTO drivers (driver_name, driver_license, depot_id) 
VALUES ('Иванов Сергей Олегович', 7777123123, 1)
```
```SQL
INSERT INTO drivers (guid, driver_name, driver_license, depot_id) 
VALUES (
    '30bfcb96-afc2-4819-bf97-7c56c863991c',
    'Свиридов Михаил Владимирович', 
    9876876876, 
    2)
```  
| guid                                | driver_name                 | driver_license | depot_id |
|-------------------------------------|-----------------------------|----------------|----------|
| 17b949d4-0806-45a3-b65f-60777766b2dd | Иванов Сергей Олегович      | 7777123123     | 1        |
| 1f8c9bd8-ae82-4712-a6c7-1bfc6b48db63 | Земцов Вячеслав Николаевич  | 4444567567     |          |
| 30bfcb96-afc2-4819-bf97-7c56c863991c | Свиридов Михаил Владимирович | 9876876876     | 2        |  

Вводить guid при вставке строк можно по-разному. Помимо стандартного варианта, можно писать так:   
* В верхнем регистре — `F01B5CBA-BC79-4123-BA67-F03729F3C779`.  
* Стандартно в фигурных скобках — `f01b5cba-bc79-4123-ba67-f03729f3c779}`.  
* Стандартно без - `—` `f01b5cbabc794123ba67f03729f3c779`.  
* Стандартно с `-`, который разделит строку на группы по четыре символа, — `f01b-5cba-bc79-4123-ba67-f037-29f3-c779`.  

## Преимущества и недостатки UUID
| Преимущества UUID                          | Недостатки UUID                          |
|-------------------------------------------|-----------------------------------------|
| Глобальная уникальность (практически исключены коллизии) | Сложность ручного ввода (требуется копирование) |
| Сквозная идентификация между разными БД и системами | Снижение производительности на больших таблицах |
| Криптографическая стойкость (защита от подбора) | Проблемы с кластеризацией из-за случайности значений |
| Компактнее строковых аналогов (16 байт) | Отсутствие естественной сортировки |
| Автономная генерация (не требует обращения к серверу) | Увеличение размера индексов |  

**Рекомендации по применению:**
- Идеально для распределённых систем и микросервисов
- Лучший выбор при интеграции разнородных БД
- Не рекомендуется для высоконагруженных таблиц с частыми INSERT  

