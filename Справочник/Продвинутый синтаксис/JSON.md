# JSON

`json` — это текстовый формат, который может содержать две сущности:  
* Объект json.  
* Массив.  

## Объект JSON  
Основу структуры JSON составляет объект, представленный в виде неупорядоченного множества пар «ключ: значение». Данные заключаются в фигурные скобки `{}`, а элементы внутри разделяются запятыми. В качестве наглядного примера можно рассмотреть JSON-объект, содержащий информацию о сотруднике:  

```sql
{
    "Имя": "Иван",
    "Фамилия": "Ивано",
    "Год ролждения": 1975
}
```

В роли ключей допустимы исключительно строковые значения, обязательно заключенные в кавычки. Именно эта строгая нотация применяется в СУБД PostgreSQL для работы с JSON-данными.  
В отличие от него, существуют иные стандарты сериализации данных, такие как JSON5, где правила менее строгие. К примеру, в JSON5 ключом может выступать число, и в таком случае его заключать в кавычки не требуется.  

Что касается значений в JSON-объекте, их тип может быть одним из следующих:  
* Строка (в кавычках)  
* Число (целое или с плавающей точкой)  
* Булев тип (true или false)  
* Массив (упорядоченный список значений в квадратных скобках)  
* Вложенный JSON-объект (набор пар ключ-значение в фигурных скобках)  

Объекты JSON поддерживают вложенность, например:  
```sql
{
    "Имя": "Иван",
    "Фамилия": "Ивано",
    "Год ролждения": 1975,
    "Дети" : {
             "Имя":"Алексей",
              "Год рождения": 2000
    }
}
```  

## Массив JSON
Массив JSON практически то же, что и обычный массив. Пример такого массива:  
```sql
[
    {
        "название": "Смартфон",
        "цена": 29999,
        "категория": "Электроника",
        "вНаличии": true
    },
    {
        "название": "Кофемашина",
        "цена": 45990,
        "категория": "Бытовая техника",
        "вНаличии": false
    },
    {
        "название": "Футболка",
        "цена": 2499,
        "категория": "Одежда",
        "вНаличии": true
    }
]
```  
Массив может быть вложен в объект:  
```sql
{
    "имя": "Иван",
    "дети": [
        {
            "имя": "Алёна"
        },
        {
            "имя": "Макар"
        }
    ],
    "возраст": 25,
    "фамилия": "Иванов"
}
```

# JSONB
Выглядит также как и обычный JSON о данные хранит в бинарном формате, отсюда такое название.  
| Критерий | JSON | JSONB |
| :--- | :--- | :--- |
| **Работа с сохранением** | | |
| Формат хранения | Сохраняет точную текстовую копию | Сохраняет в разобранном двоичном виде |
| Незначимые пробелы | Сохраняются | Удаляются |
| Повторяющиеся ключи | Сохраняются все (при выборке возвращается последний) | Сохраняется только последний |
| **Скорость** | | |
| Порядок ключей | Сохраняется | Не сохраняется |
| Скорость записи (ввода) | **Выше** (простое сохранение текста) | **Ниже** (затраты на бинарный разбор и преобразование) |
| Скорость чтения (обработки) | **Ниже** (требуется повторный разбор) | **Выше** (данные готовы для обработки) |
| **Функциональность** | | |
| Поддержка индексации | Нет | **Да** |
| Операторы (конкатенация, вхождение и др.) | Нет | **Да** |
| Функции для изменения ключей/значений | Нет | **Да** |

# Объявление полей JSON
```sql
ALTER TABLE test.clients ADD COLUMN worksheet_json json;
ALTER TABLE test.clients ADD COLUMN worksheet_jsonb jsonb;
```

# Создание json/jsonb
